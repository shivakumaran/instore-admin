/*!
 * jQuery FN Google Map 3.0-rc
 * http://code.google.com/p/jquery-ui-map/
 * Copyright (c) 2010 - 2012 Johan SÃ¤ll Larsson
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */
(function(a){a.a=function(b,c){var d=b.split(".")[0];b=b.split(".")[1],a[d]=a[d]||{},a[d][b]=function(a,b){arguments.length&&this._setup(a,b)},a[d][b].prototype=a.extend({namespace:d,pluginName:b},c),a.fn[b]=function(c){var e=typeof c=="string",f=Array.prototype.slice.call(arguments,1),g=this;return e&&c.substring(0,1)==="_"?g:(this.each(function(){var h=a.data(this,b);h||(h=a.data(this,b,new a[d][b](c,this))),e&&(g=h[c].apply(h,f))}),g)}},a.a("ui.gmap",{options:{mapTypeId:"roadmap",zoom:5},option:function(a,b){return b?(this.options[a]=b,this.get("map").set(a,b),this):this.options[a]},_setup:function(a,b){this.el=b,a=a||{},jQuery.extend(this.options,a,{center:this._latLng(a.center)}),this._create(),this._init&&this._init()},_create:function(){var b=this;this.instance={map:new google.maps.Map(b.el,b.options),markers:[],overlays:[],services:[]},google.maps.event.addListenerOnce(b.instance.map,"bounds_changed",function(){a(b.el).trigger("init",b.instance.map)}),b._call(b.options.callback,b.instance.map)},addBounds:function(a){var b=this.get("bounds",new google.maps.LatLngBounds);return b.extend(this._latLng(a)),this.get("map").fitBounds(b),this},inViewport:function(a){var b=this.get("map").getBounds();return b?b.contains(a.getPosition()):!1},addControl:function(a,b){return this.get("map").controls[b].push(this._unwrap(a)),this},addMarker:function(b,c){b.map=this.get("map"),b.position=this._latLng(b.position);var d=new(b.marker||google.maps.Marker)(b),e=this.get("markers");return d.id?e[d.id]=d:e.push(d),d.bounds&&this.addBounds(d.getPosition()),this._call(c,b.map,d),a(d)},clear:function(a){return this._c(this.get(a)),this.set(a,[]),this},_c:function(a){for(var b in a)a.hasOwnProperty(b)&&(a[b]instanceof google.maps.MVCObject?(google.maps.event.clearInstanceListeners(a[b]),a[b].setMap&&a[b].setMap(null)):a[b]instanceof Array&&this._c(a[b]),a[b]=null)},find:function(b,c,d){var e=this.get(b);c.value=a.isArray(c.value)?c.value:[c.value];for(var f in e)if(e.hasOwnProperty(f)){var g=!1;for(var h in c.value)if(a.inArray(c.value[h],e[f][c.property])>-1)g=!0;else if(c.operator&&c.operator==="AND"){g=!1;break}d(e[f],g)}return this},get:function(a,b){var c=this.instance;if(!c[a]){if(a.indexOf(">")>-1){var d=a.replace(/ /g,"").split(">");for(var e=0;e<d.length;e++){if(!c[d[e]]){if(!b)return null;c[d[e]]=e+1<d.length?[]:b}c=c[d[e]]}return c}b&&!c[a]&&this.set(a,b)}return c[a]},openInfoWindow:function(a,b,c){var d=this.get("iw",a.infoWindow||new google.maps.InfoWindow);return d.setOptions(a),d.open(this.get("map"),this._unwrap(b)),this._call(c,d),this},closeInfoWindow:function(){return this.get("iw")!=null&&this.get("iw").close(),this},set:function(a,b){return this.instance[a]=b,this},refresh:function(){var b=this.get("map"),c=b.getCenter();return a(b).triggerEvent("resize"),b.setCenter(c),this},destroy:function(){this.clear("markers").clear("services").clear("overlays")._c(this.instance),jQuery.removeData(this.el,this.name)},_call:function(b){b&&a.isFunction(b)&&b.apply(this,Array.prototype.slice.call(arguments,1))},_latLng:function(a){return a?a instanceof google.maps.LatLng?a:(a=a.replace(/ /g,"").split(","),new google.maps.LatLng(a[0],a[1])):new google.maps.LatLng(0,0)},_unwrap:function(b){return b?b instanceof jQuery?b[0]:b instanceof Object?b:a("#"+b)[0]:null}}),jQuery.fn.extend({triggerEvent:function(a){return google.maps.event.trigger(this[0],a),this},addEventListener:function(a,b,c){return google.maps&&this[0]instanceof google.maps.MVCObject?google.maps.event.addListener(this[0],a,b):c?this.bind(a,b,c):this.bind(a,b),this}}),jQuery.each("click rightclick dblclick mouseover mouseout drag dragend".split(" "),function(a,b){jQuery.fn[b]=function(a,c){return this.addEventListener(b,a,c)}})})(jQuery),function(a){a.extend(a.ui.gmap.prototype,{getCurrentPosition:function(a,b){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(b){a(b,"OK")},function(b){a(null,b)},b):a(null,"NOT_SUPPORTED")},watchPosition:function(a,b){navigator.geolocation?this.set("watch",navigator.geolocation.watchPosition(function(b){a(b,"OK")},function(b){a(null,b)},b)):a(null,"NOT_SUPPORTED")},clearWatch:function(){navigator.geolocation&&navigator.geolocation.clearWatch(this.get("watch"))},autocomplete:function(b,c){var d=this;a(this._unwrap(b)).autocomplete({source:function(b,c){d.search({address:b.term},function(b,d){d==="OK"?c(a.map(b,function(a){return{label:a.formatted_address,value:a.formatted_address,position:a.geometry.location}})):d==="OVER_QUERY_LIMIT"&&alert("Google said it's too much!")})},minLength:3,select:function(a,b){d._call(c,b)},open:function(){a(this).removeClass("ui-corner-all").addClass("ui-corner-top")},close:function(){a(this).removeClass("ui-corner-top").addClass("ui-corner-all")}})},placesSearch:function(a,b){this.get("services > PlacesService",new google.maps.places.PlacesService(this.get("map"))).search(a,b)},clearDirections:function(){var a=this.get("services > DirectionsRenderer");a&&(a.setMap(null),a.setPanel(null))},pagination:function(b){var c=a("<div id='pagination' class='pagination shadow gradient rounded clearfix'><div class='lt btn back-btn'></div><div class='lt display'></div><div class='rt btn fwd-btn'></div></div>"),d=this,e=0,b=b||"title";d.set("p_nav",function(a,f){a&&(e+=f,c.find(".display").text(d.get("markers")[e][b]),d.get("map").panTo(d.get("markers")[e].getPosition()))}),d.get("p_nav")(!0,0),c.find(".back-btn").click(function(){d.get("p_nav")(e>0,-1,this)}),c.find(".fwd-btn").click(function(){d.get("p_nav")(e<d.get("markers").length-1,1,this)}),d.addControl(c,google.maps.ControlPosition.TOP_LEFT)}})}(jQuery);